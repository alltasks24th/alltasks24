<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>หลังบ้าน • รับจ้างสารพัด 24 ชั่วโมง</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="assets/css/styles.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600;700&display=swap" rel="stylesheet">
</head>
<body class="bg-midnight text-light">
  <nav class="navbar navbar-dark bg-darker border-bottom border-neon sticky-top">
    <div class="container">
      <span class="navbar-brand fw-bold">หลังบ้าน</span>
      <div class="d-flex gap-2">
        <span id="adminRole" class="badge bg-neon-dark text-neon"></span>
        <a href="index.html" class="btn btn-outline-neon btn-sm">ดูหน้าเว็บ</a>
        <button id="btnLogout" class="btn btn-neon btn-sm">ออกจากระบบ</button>
      </div>
    </div>
  </nav>

  <div class="container py-4">
    <div class="row g-3">
      <div class="col-lg-3">
        <div class="list-group list-group-flush sticky-top top-4">
          <button class="list-group-item list-group-item-action active" data-target="#tab-dashboard">แดชบอร์ด</button>
          <button class="list-group-item list-group-item-action" data-target="#tab-services">บริการ</button>
          <button class="list-group-item list-group-item-action" data-target="#tab-areas">พื้นที่</button>
          <button class="list-group-item list-group-item-action" data-target="#tab-bookings">การจอง</button>
          <button class="list-group-item list-group-item-action" data-target="#tab-tickets">คำขอ/แจ้งปัญหา</button>
          <button class="list-group-item list-group-item-action" data-target="#tab-reviews">รีวิว</button>
          <button class="list-group-item list-group-item-action" data-target="#tab-promos">โปรโมชัน</button>
          <button class="list-group-item list-group-item-action" data-target="#tab-banners">แบนเนอร์</button>
          <button class="list-group-item list-group-item-action" data-target="#tab-faq">FAQ</button>
          <button class="list-group-item list-group-item-action" data-target="#tab-settings">ตั้งค่า</button>
          <button class="list-group-item list-group-item-action" data-target="#tab-chat">แชตสด</button>
          <button class="list-group-item list-group-item-action" data-target="#tab-users">ผู้ใช้/บทบาท</button>
        </div>
      </div>
      <div class="col-lg-9">

        <!-- Dashboard -->
        <section id="tab-dashboard" class="admin-tab">
          <h2>แดชบอร์ดสรุปสถิติ</h2>
          <div class="row g-3">
            <div class="col-md-3"><div class="stat-card"><div class="stat-label">การจอง</div><div id="statBookings" class="stat-value">0</div></div></div>
            <div class="col-md-3"><div class="stat-card"><div class="stat-label">รีวิว</div><div id="statReviews" class="stat-value">0</div></div></div>
            <div class="col-md-3"><div class="stat-card"><div class="stat-label">แชต</div><div id="statChats" class="stat-value">0</div></div></div>
            <div class="col-md-3"><div class="stat-card"><div class="stat-label">โปรโมชัน</div><div id="statPromos" class="stat-value">0</div></div></div>
          </div>
        </section>

        <!-- Services -->
        <section id="tab-services" class="admin-tab d-none">
          <div class="d-flex justify-content-between align-items-center">
            <h2>จัดการบริการ</h2>
            <button id="addService" class="btn btn-neon btn-sm">เพิ่มบริการ</button>
          </div>
          <div class="table-responsive mt-3">
            <table class="table table-dark table-striped">
              <thead><tr><th>ชื่อ</th><th>หมวดหมู่</th><th>คำอธิบาย</th><th>รูป</th><th class="text-end">จัดการ</th></tr></thead>
              <tbody id="tblServicesBody"></tbody>
            </table>
          </div>
        </section>

        <!-- Areas -->
        <section id="tab-areas" class="admin-tab d-none">
          <div class="d-flex justify-content-between align-items-center">
            <h2>จัดการพื้นที่</h2>
            <button id="addArea" class="btn btn-neon btn-sm">เพิ่มพื้นที่</button>
          </div>
          <div class="table-responsive mt-3">
            <table class="table table-dark table-striped">
              <thead><tr><th>ชื่อ</th><th>จังหวัด</th><th>ขอบเขต (GeoJSON)</th><th class="text-end">จัดการ</th></tr></thead>
              <tbody id="tblAreasBody"></tbody>
            </table>
          </div>
        </section>

        <!-- Bookings -->
        <section id="tab-bookings" class="admin-tab d-none">
          <h2>จัดการการจองงาน</h2>
          <div class="table-responsive mt-3">
            <table class="table table-dark table-striped">
              <thead><tr><th>ชื่อ</th><th>เบอร์</th><th>บริการ</th><th>พื้นที่</th><th>วัน/เวลา</th><th>สถานะ</th><th class="text-end">จัดการ</th></tr></thead>
              <tbody id="tblBookingsBody"></tbody>
            </table>
          </div>
        </section>

        <!-- Tickets -->
        <section id="tab-tickets" class="admin-tab d-none">
          <h2>คำขอใบเสนอราคา / แจ้งปัญหา</h2>
          <div class="table-responsive mt-3">
            <table class="table table-dark table-striped">
              <thead><tr><th>อีเมล</th><th>หัวข้อ</th><th>ข้อความ</th><th>สถานะ</th><th class="text-end">จัดการ</th></tr></thead>
              <tbody id="tblTicketsBody"></tbody>
            </table>
          </div>
        </section>

        <!-- Reviews -->
        <section id="tab-reviews" class="admin-tab d-none">
          <h2>จัดการรีวิว</h2>
          <div class="table-responsive mt-3">
            <table class="table table-dark table-striped">
              <thead><tr><th>ชื่อ</th><th>คะแนน</th><th>ข้อความ</th><th>สถานะ</th><th class="text-end">จัดการ</th></tr></thead>
              <tbody id="tblReviewsBody"></tbody>
            </table>
          </div>
        </section>

        <!-- Promos -->
        <section id="tab-promos" class="admin-tab d-none">
          <div class="d-flex justify-content-between align-items-center">
            <h2>โปรโมชัน</h2>
            <button id="addPromo" class="btn btn-neon btn-sm">เพิ่มโปรโมชัน</button>
          </div>
          <div class="table-responsive mt-3">
            <table class="table table-dark table-striped">
              <thead><tr><th>ชื่อ</th><th>ช่วงเวลา</th><th>รูป</th><th class="text-end">จัดการ</th></tr></thead>
              <tbody id="tblPromosBody"></tbody>
            </table>
          </div>
        </section>

        <!-- Banners -->
        <section id="tab-banners" class="admin-tab d-none">
          <div class="d-flex justify-content-between align-items-center">
            <h2>แบนเนอร์สไลด์</h2>
            <button id="addBanner" class="btn btn-neon btn-sm">เพิ่มแบนเนอร์</button>
          </div>
          <div class="table-responsive mt-3">
            <table class="table table-dark table-striped">
              <thead><tr><th>หัวข้อ</th><th>คำโปรย</th><th>รูป</th><th class="text-end">จัดการ</th></tr></thead>
              <tbody id="tblBannersBody"></tbody>
            </table>
          </div>
        </section>

        <!-- FAQ -->
        <section id="tab-faq" class="admin-tab d-none">
          <div class="d-flex justify-content-between align-items-center">
            <h2>FAQ</h2>
            <button id="addFaq" class="btn btn-neon btn-sm">เพิ่มคำถาม</button>
          </div>
          <div class="table-responsive mt-3">
            <table class="table table-dark table-striped">
              <thead><tr><th>คำถาม</th><th>คำตอบ</th><th class="text-end">จัดการ</th></tr></thead>
              <tbody id="tblFaqBody"></tbody>
            </table>
          </div>
        </section>

        <!-- Settings -->
        <section id="tab-settings" class="admin-tab d-none">
          <h2>ตั้งค่าทั่วไป</h2>
          <form id="settingsForm" class="card card-neon p-3">
            <div class="row g-3">
              <div class="col-md-6"><label class="form-label">ชื่อเว็บ</label><input name="siteName" class="form-control form-control-neon"></div>
              <div class="col-md-6"><label class="form-label">Hero Text</label><input name="heroText" class="form-control form-control-neon"></div>
              <div class="col-md-4"><label class="form-label">เบอร์โทร</label><input name="phone" class="form-control form-control-neon"></div>
              <div class="col-md-4"><label class="form-label">LINE ID (@...)</label><input name="line" class="form-control form-control-neon"></div>
              <div class="col-md-4"><label class="form-label">Facebook URL</label><input name="facebook" class="form-control form-control-neon"></div>
              <div class="col-12"><label class="form-label">Google Maps Embed URL</label><input name="mapUrl" class="form-control form-control-neon"></div>
              <div class="col-12"><label class="form-label">นโยบายสื่อ</label><textarea name="policyText" class="form-control form-control-neon"></textarea></div>
            </div>
            <div class="d-flex gap-2 mt-3">
              <button class="btn btn-neon" id="btnSaveSettings" type="button">บันทึก</button>
              <span id="settingsMsg" class="small text-muted"></span>
            </div>
          </form>
        </section>

        <!-- Chat -->
        <section id="tab-chat" class="admin-tab d-none">
          <h2>แชตสด</h2>
          <div class="row g-3">
            <div class="col-lg-4">
              <ul id="chatThreadList" class="list-group list-group-flush bg-darker rounded-3" style="max-height:420px; overflow:auto;"></ul>
            </div>
            <div class="col-lg-8">
              <div id="chatPane" class="card card-neon p-0">
                <div class="chat-header d-flex justify-content-between align-items-center px-3 py-2">
                  <span>ห้องสนทนา</span>
                  <span id="badgeChatTotal" class="badge bg-danger"></span>
                </div>
                <div id="chatMessagesAdmin" class="chat-body"></div>
                <div class="chat-input p-2 border-top border-neon">
                  <div class="input-group">
                    <input id="chatInputAdmin" class="form-control form-control-neon" placeholder="พิมพ์ข้อความ...">
                    <button id="chatSendAdmin" class="btn btn-neon">ส่ง</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- Users -->
        <section id="tab-users" class="admin-tab d-none">
          <h2>ผู้ใช้และบทบาท</h2>
          <div class="table-responsive mt-3">
            <table class="table table-dark table-striped">
              <thead><tr><th>UID</th><th>อีเมล</th><th>บทบาท</th></tr></thead>
              <tbody id="tblUsersBody"></tbody>
            </table>
          </div>
          <div class="alert alert-dark">หมายเหตุ: เพิ่ม/ลบแอดมินได้ที่เอกสาร <code>settings/acl</code> (field <code>admins</code> เป็น array ของ UID)</div>
        </section>

      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script type="module" src="assets/js/admin.js"></script>
</body>
</html>
